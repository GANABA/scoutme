// This is your Prisma schema file
// Learn more: https://pris.ly/d/prisma-schema

generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

// ============================================
// MODELS - MVP
// ============================================

enum UserType {
  player
  recruiter
  admin
}

model User {
  id           String   @id @default(uuid()) @db.Uuid
  email        String   @unique @db.VarChar(255)
  passwordHash String   @map("password_hash") @db.VarChar(255)
  userType     UserType @map("user_type")
  createdAt    DateTime @default(now()) @map("created_at")
  updatedAt    DateTime @updatedAt @map("updated_at")

  // Relations
  player    Player?
  recruiter Recruiter?

  @@map("users")
}

enum Foot {
  left
  right
  both
}

enum PlayerStatus {
  pending
  active
  suspended
}

model Player {
  id                 String        @id @default(uuid()) @db.Uuid
  userId             String        @unique @map("user_id") @db.Uuid
  fullName           String        @map("full_name") @db.VarChar(255)
  birthDate          DateTime      @map("birth_date") @db.Date
  nationality        String?       @db.VarChar(100)
  city               String?       @db.VarChar(100)
  country            String        @db.VarChar(100)
  primaryPosition    String        @map("primary_position") @db.VarChar(50)
  secondaryPositions Json          @default("[]") @map("secondary_positions") @db.JsonB
  strongFoot         Foot?         @map("strong_foot")
  heightCm           Int?          @map("height_cm")
  weightKg           Int?          @map("weight_kg")
  currentClub        String?       @map("current_club") @db.VarChar(255)
  careerHistory      String?       @map("career_history") @db.Text
  phone              String?       @db.VarChar(50)
  profilePhotoUrl    String?       @map("profile_photo_url") @db.VarChar(500)
  videoUrls          Json          @default("[]") @map("video_urls") @db.JsonB
  status             PlayerStatus  @default(active)
  createdAt          DateTime      @default(now()) @map("created_at")
  updatedAt          DateTime      @updatedAt @map("updated_at")

  // Relations
  user User @relation(fields: [userId], references: [id], onDelete: Cascade)

  @@index([country])
  @@index([primaryPosition])
  @@index([status])
  @@map("players")
}

enum OrganizationType {
  club
  academy
  agency
  other
}

enum RecruiterStatus {
  pending
  approved
  rejected
  suspended
}

model Recruiter {
  id               String            @id @default(uuid()) @db.Uuid
  userId           String            @unique @map("user_id") @db.Uuid
  fullName         String            @map("full_name") @db.VarChar(255)
  organizationName String            @map("organization_name") @db.VarChar(255)
  organizationType OrganizationType  @map("organization_type")
  country          String            @db.VarChar(100)
  contactEmail     String?           @map("contact_email") @db.VarChar(255)
  contactPhone     String?           @map("contact_phone") @db.VarChar(50)
  status           RecruiterStatus   @default(pending)
  approvedBy       String?           @map("approved_by") @db.Uuid
  approvedAt       DateTime?         @map("approved_at")
  createdAt        DateTime          @default(now()) @map("created_at")
  updatedAt        DateTime          @updatedAt @map("updated_at")

  // Relations
  user User @relation(fields: [userId], references: [id], onDelete: Cascade)

  @@index([status])
  @@map("recruiters")
}
